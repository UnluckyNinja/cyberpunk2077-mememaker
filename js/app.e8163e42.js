(function(e){function t(t){for(var r,i,o=t[0],c=t[1],l=t[2],g=0,d=[];g<o.length;g++)i=o[g],n[i]&&d.push(n[i][0]),n[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,o=1;o<a.length;o++){var c=a[o];0!==n[c]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={app:0},s=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"0db9":function(e,t,a){"use strict";var r=a("40a9"),n=a.n(r);n.a},"40a9":function(e,t,a){},5339:function(e,t,a){e.exports=a.p+"img/cyberpunk_zh.2bea1920.png"},"5c0b":function(e,t,a){"use strict";var r=a("5e27"),n=a.n(r);n.a},"5e27":function(e,t,a){},c69f:function(e,t,a){},cd49:function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("el-container",{staticStyle:{"min-height":"100vh"}},[a("el-header",{staticClass:"header vertical-center"},[e._v("赛博朋克2077沙雕图生成器")]),a("el-main",{staticClass:"main"},[a("MemeMaker")],1),a("el-footer",{staticClass:"footer vertical-center"},[e._v("© 2019 UnluckyNinja")])],1)],1)},s=[],i=a("9ab4"),o=a("60a3"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper",on:{paste:e.pasteImage}},[a("div",{staticClass:"flex-horizontal"},[a("el-button",{attrs:{type:"primary",disabled:e.currentStep<=0},on:{click:e.previous}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",disabled:e.currentStep>=2},on:{click:e.next}},[e._v("下一步")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.currentStep,expression:"currentStep == 0"}],key:"0",staticClass:"mememaker filepicker vertical-center"},[0==e.currentStep?a("el-upload",{attrs:{drag:"",action:"nowhere",accept:"image/*",limit:1,"auto-upload":!1,"show-file-list":!0,"on-change":e.changeImage}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("\n        将文件拖到此处，或\n        "),a("em",[e._v("点击上传")]),e._v("\n        或在正文区域粘贴（CTRL+V）\n      ")])]):e._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.currentStep,expression:"currentStep == 1"}],key:"1",staticClass:"mememaker editor flex-column"},[a("el-radio-group",{on:{change:e.changeLogo},model:{value:e.logo,callback:function(t){e.logo=t},expression:"logo"}},[a("el-radio",{attrs:{border:"",label:"zh"}},[e._v("中文")]),a("el-radio",{attrs:{border:"",label:"en"}},[e._v("English")])],1),a("v-stage",{ref:"stage",staticClass:"horizontal-center",attrs:{config:{width:100,height:100}}},[a("v-layer",[e.finishedLoadImage?a("v-image",{attrs:{config:{width:e.image.naturalWidth,height:e.image.naturalHeight,image:e.image}}}):e._e()],1),a("v-layer",{ref:"logoLayer"})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2==e.currentStep,expression:"currentStep == 2"}],key:"2",staticClass:"mememaker result horizontal-center"},[e.outputImage?a("el-image",{staticStyle:{width:"fit-content",height:"fit-content"},attrs:{src:e.outputImage.src,fit:"none"}}):e._e()],1),a("el-steps",{staticClass:"step",attrs:{active:e.currentStep,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"选择图片"}}),a("el-step",{attrs:{title:"沙雕炼成"}}),a("el-step",{attrs:{title:"复制图片"}})],1)],1)},l=[],u=a("1da1"),g=a("362d"),d=a.n(g);let h=class extends o["b"]{constructor(){super(...arguments),this.target="",this.currentStep=0,this.image=new Image,this.finishedLoadImage=!1,this.logo="en",this.outputImage=null}get stage(){const e=this.$refs.stage;return e.getNode()}get logoLayer(){const e=this.$refs.logoLayer;return e.getNode()}next(){this.currentStep<2&&this.currentStep++,1===this.currentStep&&this.changeLogo(this.logo),2===this.currentStep&&(this.clearTransform(),this.stage.toImage({callback:e=>{this.outputImage=e}}))}clearTransform(){this.stage.find("Transformer").each(e=>{e.destroy()})}mounted(){this.stage.on("click tap",e=>{if(!e.target.hasName("logo"))return this.clearTransform(),void this.logoLayer.draw();this.stage.find("Transformer").each(e=>{e.destroy()});const t=new d.a.Transformer;this.logoLayer.add(t),t.attachTo(e.target),this.logoLayer.draw()})}previous(){this.currentStep>0&&this.currentStep--}pasteImage(e){var t=this;return Object(u["a"])(function*(){let a;for(const t of e.clipboardData.items)if(t&&t.type.startsWith("image")){a=t;break}if(!a)return;const r=a.getAsFile();if(r)yield t.loadImage(r),t.next();else{const e=t;e.$message({showClose:!0,message:"图片文件错误，如果从QQ聊天中复制，请对双击图片后的大图右键复制",type:"error"})}})()}changeImage(e,t){var a=this;return Object(u["a"])(function*(){if(e&&e.raw)return yield a.loadImage(e.raw),a.next(),!0})()}loadImage(e){var t=this;return Object(u["a"])(function*(){""!==t.image.src&&(URL.revokeObjectURL(t.image.src),t.image.removeAttribute("src"));const a=new Promise((e,a)=>{return t.image.addEventListener("load",()=>{let a=t.$refs.stage;a=a.getNode(),a.width(t.image.naturalWidth),a.height(t.image.naturalHeight),t.finishedLoadImage=!0,t.stage.draw(),e(!0)})});return t.image.src=URL.createObjectURL(e),a})()}changeLogo(e){"zh"===e?this.loadLogo(a("5339")):"en"===e&&this.loadLogo(a("d58f"))}loadLogo(e){const t=new Image;t.addEventListener("load",()=>{const e=.8*this.stage.width()/t.naturalWidth,a=new d.a.Image({name:"logo",image:t,draggable:!0,x:(this.stage.width()-t.naturalWidth*e)/2,y:.9*(this.stage.height()-t.naturalHeight*e)});a.scale({x:e,y:e}),a.transformsEnabled(),this.logoLayer.removeChildren(),this.logoLayer.add(a),this.logoLayer.draw()}),t.src=e}};h=i["a"]([Object(o["a"])({components:{}})],h);var p=h,f=p,m=(a("0db9"),a("2877")),v=Object(m["a"])(f,c,l,!1,null,"2cf2f9cc",null),b=v.exports;let y=class extends o["b"]{};y=i["a"]([Object(o["a"])({components:{MemeMaker:b}})],y);var w=y,_=w,x=(a("5c0b"),Object(m["a"])(_,n,s,!1,null,null,null)),L=x.exports,S=a("2f62");r["default"].use(S["a"]);var k=new S["a"].Store({state:{},mutations:{},actions:{}}),j=a("5c96"),I=a.n(j);a("c69f");r["default"].use(I.a);var O=a("7591"),C=a.n(O);r["default"].use(C.a),r["default"].config.productionTip=!1,new r["default"]({store:k,render:e=>e(L)}).$mount("#app")},d58f:function(e,t,a){e.exports=a.p+"img/cyberpunk_en.28275215.png"}});
//# sourceMappingURL=app.e8163e42.js.map