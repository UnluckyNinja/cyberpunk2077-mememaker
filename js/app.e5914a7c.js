(function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],g=0,f=[];g<s.length;g++)o=s[g],n[o]&&f.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={app:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/cyberpunk2077-mememaker/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"0408":function(e,t,a){"use strict";var r=a("8efe"),n=a.n(r);n.a},"41a9":function(e,t,a){"use strict";var r=a("62d4"),n=a.n(r);n.a},5339:function(e,t,a){e.exports=a.p+"img/cyberpunk_zh.2bea1920.png"},"5c0b":function(e,t,a){"use strict";var r=a("5e27"),n=a.n(r);n.a},"5c37":function(e,t,a){},"5e27":function(e,t,a){},"62d4":function(e,t,a){},"879c":function(e,t,a){"use strict";var r=a("5c37"),n=a.n(r);n.a},"8efe":function(e,t,a){},c69f:function(e,t,a){},cd49:function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("el-container",{staticStyle:{"min-height":"100vh"}},[a("el-header",{staticClass:"header vertical-center"},[e._v("赛博朋克2077沙雕图生成器")]),a("el-main",{staticClass:"main"},[a("MemeMaker")],1),a("el-footer",{staticClass:"footer vertical-center"},[e._v("© 2019 UnluckyNinja")])],1)],1)},i=[],o=a("d225"),s=a("308d"),c=a("6bb5"),l=a("4e2b"),u=a("9ab4"),g=a("60a3"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:e.processing,expression:"processing",modifiers:{fullscreen:!0}}],staticClass:"maker",attrs:{"element-loading-text":"沙雕炼成中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-customClass":"loading-overlay"},on:{paste:e.onPaste}},[a("div",{staticClass:"flex-horizontal"},[a("el-button",{attrs:{type:"primary",loading:e.processing,disabled:e.currentStep<=0},on:{click:e.previous}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",loading:e.processing,disabled:e.currentStep>=2},on:{click:e.next}},[e._v("下一步")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.currentStep,expression:"currentStep === 0"}],key:"0",staticClass:"mememaker filepicker vertical-center"},[0===e.currentStep?a("FilePicker",{ref:"filePicker",on:{"image-load":e.imageLoad}}):e._e()],1),a("KonvaEditor",{directives:[{name:"show",rawName:"v-show",value:1===e.currentStep,expression:"currentStep === 1"}],key:"1",ref:"editor",staticClass:"mememaker editor flex-vertical",attrs:{image:e.image}}),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.currentStep,expression:"currentStep === 2"}],key:"2",staticClass:"mememaker result vertical-center"},[""!==e.outputImage?a("el-image",{staticStyle:{"align-self":"center"},attrs:{src:e.outputImage,fit:"contain"}}):e._e(),a("div"),a("a",{attrs:{href:e.outputImage,download:""}},[a("el-button",{attrs:{type:"success"}},[e._v("保存图片")])],1)],1),a("el-steps",{staticClass:"step",attrs:{active:e.currentStep,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"选择图片"}}),a("el-step",{attrs:{title:"沙雕炼成"}}),a("el-step",{attrs:{title:"复制图片"}})],1)],1)},h=[],d=a("b0b4"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-upload",{attrs:{drag:"",action:"nowhere",accept:"image/*",limit:1,"auto-upload":!1,"show-file-list":!0,"on-change":e.changeImage}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("\n    将文件拖到此处，或\n    "),a("em",[e._v("点击上传")]),a("br"),e._v("你也可以复制图片，然后点击正文区域并粘贴（CTRL+V）\n  ")])])},m=[],v=(a("96cf"),a("3b8d")),b=(a("f559"),a("ac4d"),a("8a81"),a("ac6a"),function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.target="",e.image=new Image,e}return Object(l["a"])(t,e),Object(d["a"])(t,[{key:"pasteImage",value:function(e){var t,a=!0,r=!1,n=void 0;try{for(var i,o=e.clipboardData.items[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var s=i.value;if(s&&s.type.startsWith("image")){t=s;break}}}catch(u){r=!0,n=u}finally{try{a||null==o.return||o.return()}finally{if(r)throw n}}if(t){var c=t.getAsFile();if(c)this.loadImage(c);else{var l=this;l.$message({showClose:!0,message:"图片文件错误，如果从QQ聊天中复制，请对双击图片后的大图右键复制",type:"error"})}}}},{key:"changeImage",value:function(e,t){if(e&&e.raw)return this.loadImage(e.raw),!1}},{key:"loadImage",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:""!==this.image.src&&(URL.revokeObjectURL(this.image.src),this.image.removeAttribute("src")),a=new Promise(function(e,t){return r.image.addEventListener("load",function(){e(!0)})}),this.image.src=URL.createObjectURL(t),a.then(function(){r.$emit("image-load",r.image)});case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}]),t}(g["c"]));b=u["a"]([Object(g["a"])({components:{}})],b);var y=b,k=y,w=(a("41a9"),a("2877")),j=Object(w["a"])(k,p,m,!1,null,"3c3fcef9",null),O=j.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper"},[a("el-radio-group",{on:{change:e.changeLogo},model:{value:e.logo,callback:function(t){e.logo=t},expression:"logo"}},[a("el-radio",{attrs:{border:"",label:"zh"}},[e._v("中文")]),a("el-radio",{attrs:{border:"",label:"en"}},[e._v("English")])],1),a("v-stage",{ref:"stage",staticClass:"horizontal-center",attrs:{config:{width:100,height:100}}},[a("v-layer",[e.finishedLoadImage?a("v-image",{attrs:{config:{width:e.image.naturalWidth,height:e.image.naturalHeight,image:e.image}}}):e._e()],1),a("v-layer",{ref:"logoLayer"})],1)],1)},x=[],S=(a("7514"),a("362d")),_=a.n(S),I=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.finishedLoadImage=!1,e.logo="en",e.oldImageURL="",e}return Object(l["a"])(t,e),Object(d["a"])(t,[{key:"mounted",value:function(){var e=this;this.stage.on("click tap",function(t){if(!t.target.hasName("logo"))return e.clearTransform(),void e.logoLayer.draw();e.clearTransform();var a=new _.a.Transformer;e.logoLayer.add(a),a.attachTo(t.target),e.logoLayer.draw()})}},{key:"onImageChange",value:function(){this.changeLogo(this.logo);var e=this.$refs.stage;e=e.getNode(),this.resizeCanvas(),this.finishedLoadImage=!0}},{key:"resizeCanvas",value:function(){var e=this.$refs.stage;e=e.getNode();var t=this.$el.clientWidth/this.image.naturalWidth;t>1&&(t=1),e.width(this.image.naturalWidth*t),e.height(this.image.naturalHeight*t),e.scale({x:t,y:t}),e.draw()}},{key:"changeLogo",value:function(e){"zh"===e?this.loadLogo(a("5339")):"en"===e&&this.loadLogo(a("d58f"))}},{key:"loadLogo",value:function(e){var t=this,a=new Image;a.addEventListener("load",function(){var e=t.stage.width()/t.stage.scaleX()*.8/a.naturalWidth,r=new _.a.Image({name:"logo",image:a,draggable:!0,x:(t.stage.width()/t.stage.scaleX()-a.naturalWidth*e)/2,y:.9*(t.stage.height()/t.stage.scaleY()-a.naturalHeight*e)});r.scale({x:e,y:e}),t.logoLayer.removeChildren(),t.logoLayer.add(r),t.logoLayer.draw()}),a.src=e}},{key:"clearTransform",value:function(){this.stage.find("Transformer").each(function(e){e.destroy()})}},{key:"renderImage",value:function(){var e=this;""!==this.oldImageURL&&(URL.revokeObjectURL(this.oldImageURL),this.oldImageURL=""),this.clearTransform(),this.stage.scale({x:1,y:1}),this.stage.size({width:this.image.naturalWidth,height:this.image.naturalHeight}),this.stage.draw();var t=new Promise(function(t){var a=e.stage.toCanvas({callback:function(){}});a.toBlob(function(a){var r=URL.createObjectURL(a);e.oldImageURL=r,t(r)})});return t}},{key:"stage",get:function(){var e=this.$refs.stage;return e.getNode()}},{key:"logoLayer",get:function(){var e=this.$refs.logoLayer;return e.getNode()}}]),t}(g["c"]);u["a"]([Object(g["b"])()],I.prototype,"image",void 0),u["a"]([Object(g["d"])("image")],I.prototype,"onImageChange",null),I=u["a"]([Object(g["a"])({components:{}})],I);var C=I,R=C,P=(a("0408"),Object(w["a"])(R,L,x,!1,null,"571cfa09",null)),U=P.exports,$=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.currentStep=0,e.image=new Image,e.outputImage="",e.processing=!1,e}return Object(l["a"])(t,e),Object(d["a"])(t,[{key:"openImage",value:function(){var e=window.open("about:blank","_blank");e&&e.document.write('<img src="'.concat(this.outputImage,'"></img>'))}},{key:"onPaste",value:function(e){this.$refs.filePicker.pasteImage(e)}},{key:"next",value:function(){var e=this;this.processing=!0,2!==this.nextStep?(this.currentStep<2&&this.currentStep++,this.processing=!1):this.editor.renderImage().then(function(t){e.outputImage=t,e.currentStep++,e.processing=!1})}},{key:"previous",value:function(){var e=this;if(this.processing=!0,1===this.previousStep)return Promise.resolve().then(function(){e.editor.resizeCanvas(),e.processing=!1}),void this.currentStep--;this.currentStep>0&&this.currentStep--,this.processing=!1}},{key:"imageLoad",value:function(e){this.image=e,this.next()}},{key:"editor",get:function(){return this.$refs.editor}},{key:"nextStep",get:function(){return this.currentStep+1}},{key:"previousStep",get:function(){return this.currentStep-1}}]),t}(g["c"]);$=u["a"]([Object(g["a"])({components:{FilePicker:O,KonvaEditor:U}})],$);var T=$,N=T,z=(a("879c"),Object(w["a"])(N,f,h,!1,null,"34857b51",null)),E=z.exports,M=function(e){function t(){return Object(o["a"])(this,t),Object(s["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),t}(g["c"]);M=u["a"]([Object(g["a"])({components:{MemeMaker:E}})],M);var W=M,H=W,F=(a("5c0b"),Object(w["a"])(H,n,i,!1,null,null,null)),A=F.exports,J=a("2f62");r["default"].use(J["a"]);var K=new J["a"].Store({state:{},mutations:{},actions:{}}),Q=a("5c96"),X=a.n(Q);a("c69f");r["default"].use(X.a);var B=a("7591"),D=a.n(B);r["default"].use(D.a),r["default"].config.productionTip=!1,new r["default"]({store:K,render:function(e){return e(A)}}).$mount("#app")},d58f:function(e,t,a){e.exports=a.p+"img/cyberpunk_en.28275215.png"}});
//# sourceMappingURL=app.e5914a7c.js.map